{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/components/search.vue","webpack:///./src/components/search.vue?5c8f","webpack:///./src/components/viz.vue","webpack:///./src/components/viz.vue?125b","webpack:///./src/components/facets.vue","webpack:///./src/components/facet.vue","webpack:///./src/components/facet.vue?221c","webpack:///./src/components/facets.vue?f89a","webpack:///./src/components/dlcsv.vue","webpack:///./src/components/dlcsv.vue?bf00","webpack:///./src/components/loader.vue","webpack:///./src/components/loader.vue?0b3e","webpack:///./src/App.vue?dfb6","webpack:///./src/main.js","webpack:///./src/components/viz.vue?a0bf","webpack:///./src/App.vue?b6d7","webpack:///./src/components/facet.vue?cf19"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","href","setBooks","setFacetsLoading","activeBooks","setResults","setSearchLoading","isLoading","results","query","disabled","search","type","placeholder","error","errorMessage","props","watch","this","mounted","methods","$emit","base_url","method","url","join","toLowerCase","headers","then","response","catch","render","noResults","id","ref","legend","newvalue","makeViz","aggregate_results","el_w","$refs","viz","clientWidth","margin","top","right","bottom","left","width","height","div","document","querySelector","children","forEach","child","removeChild","svg","append","attr","lowess","Tooltip","style","mouseover","event","pageX","pageY","html","title","pub_year","mouseleave","max_year","min_year","max_freq","frequency","x","domain","range","tickFormat","y","area","year","y0","ul","y1","ll","datum","selectAll","enter","on","items","languages","defaultOpen","setFacets","types","countries","series","cities","aria-label","aria-hidden","facetOpen","item","index","activateFacet","ids","activeFacet","intersection","resetFacet","undefined","computed","allIds","values","arr1","arr2","res","includes","components","Facet","books","activeFacets","facetName","intersectMany","arrs","allActiveFacets","book","parseBooks","attribute","storage","split","console","log","finally","makeCSV","convertArrayOfObjectsToCSV","args","ctr","keys","columnDelimiter","lineDelimiter","csv","encodeURI","filename","download","setAttribute","showDidyouknow","didyouknowText","didyouknowSource","didyouknow","shuffleArray","arr","Math","floor","random","interval","setInterval","text","source","clearInterval","isFacetsLoading","isSearchLoading","Search","Viz","DownloadCSV","Facets","Loader","createApp","App","mount"],"mappings":"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","file":"js/app.3881a71a.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/cookbooks/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n  <section class=\"section\">\n      <div class=\"container\">\n        <div class=\"columns\">\n          <div class=\"column is-one-quarter\">\n            <div class=\"block content\">\n              <h1 class=\"title\">Cookbooks explorer</h1>\n              <p>Search word frequencies (case-insensitive) in lots of cookbooks! \n              </p>\n              <p>Share any interesting findings on Twitter <a href=\"https://twitter.com/nicolaskb\">@nicolaskb</a> or over e-mail hi@nkb.fr, and <a href=\"https://github.com/n-kb/cookbooks\">do read the methodology.</a></p>\n            </div>\n            <div class=\"block\">\n              <Facets @facetChange='setBooks'\n                      @isLoading=\"setFacetsLoading\"></Facets>\n            </div>\n          </div>\n          <div class=\"column\">\n            <div class=\"block\">\n              <Search :activeBooks='activeBooks' \n                      @results=\"setResults\"\n                      @isLoading=\"setSearchLoading\"></Search>\n            </div>\n            <div class=\"block\">\n              <Loader v-if=\"isLoading\" :isLoading=\"isLoading\"></Loader>\n              <Viz :results=\"results\" :isLoading=\"isLoading\"></Viz>\n            </div>\n            <div class=\"block\">\n              <DownloadCSV v-if=\"!isLoading\" :results=\"results\"></DownloadCSV>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n</template>\n\n<script>\n\nimport Search from './components/search.vue'\nimport Viz from './components/viz.vue'\nimport Facets from './components/facets.vue'\nimport DownloadCSV from './components/dlcsv.vue'\nimport Loader from './components/loader.vue'\n\nexport default {\n  name: 'App',\n  data () {\n    return {\n      results: [],\n      activeBooks: [],\n      isFacetsLoading: true,\n      isSearchLoading: true\n    }\n  },\n  computed: {\n    isLoading() {\n      if (this.isFacetsLoading || this.isSearchLoading) { return true }\n      else { return false }\n    }\n  },\n  methods: {\n    setResults(value) {\n      this.results = value\n    },\n    setFacetsLoading(value) {\n      this.isFacetsLoading = value\n    },\n    setSearchLoading(value) {\n      this.isSearchLoading = value\n    },\n    setBooks(value) {\n      this.activeBooks = value\n    }\n  },\n  components: {\n    Search,\n    Viz,\n    DownloadCSV,\n    Facets,\n    Loader\n  }\n}\n</script>\n\n<style>\n  @import \"~bulma/css/bulma.css\"\n</style>\n","<template>\n  <div class=\"field has-addons\">\n    <div class=\"control is-expanded\">\n      <input v-model=\"query\" \n         :disabled=\"isLoading == true\" \n         :class=\"{'is-loading': isLoading == true}\" \n         class=\"input is-expanded\" \n         @keyup.enter=\"search()\"\n         type=\"text\" \n         placeholder=\"Keyword\">\n    </div>\n    <div class=\"control\">\n      <a class=\"button is-info\" \n         @click=\"search()\"\n         type=\"submit\">\n        Search\n      </a>\n    </div>\n  </div>\n  <div class=\"notification is-danger content\" v-if=\"error\">\n    <button class=\"delete\" @click=\"error = false\"></button>\n    <p>There was an error: {{errorMessage}}.</p>\n    <p>Please reload the page.</p>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nexport default {\n  props: ['activeBooks'],\n  data() {\n    return {\n      query: \"tomate, tomaten, tomates\",\n      isLoading: false,\n      error: false,\n      errorMessage: \"\"\n    }\n  },\n  watch : {\n    activeBooks() {\n      this.search()\n    }\n  },\n  mounted() {\n    this.search()\n  },\n  methods: {\n    search() {\n      this.isLoading = true\n      this.$emit('isLoading', true)\n\n      var base_url = process.env.NODE_ENV === 'development' ? 'http://127.0.0.1:8000/' : 'https://cookbooks-api.herokuapp.com/'\n      axios({\n        method: 'GET',\n        url: base_url + 'search?ids=' + this.activeBooks.join() + '&q=' + this.query.toLowerCase(), \n        headers: {\n                'Access-Control-Allow-Origin': '*',\n                'Content-type': 'application/json'\n            }\n        })\n        .then(response => {\n          // handle success\n          this.isLoading = false\n          this.$emit('isLoading', false)\n          this.$emit('results', response.data)\n        })\n        .catch(error => {\n          // handle error\n          this.errorMessage = error\n          this.error = true\n        })\n    }\n  }\n}\n\n</script>","import { render } from \"./search.vue?vue&type=template&id=602e05ce\"\nimport script from \"./search.vue?vue&type=script&lang=js\"\nexport * from \"./search.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"notification is-warning\" v-if=\"noResults\">\n    <button class=\"delete\" @click=\"noResults = false\"></button>\n    Your search returned no results.\n  </div>\n  <div id=\"viz\" ref=\"viz\" :class=\"{'invisible': isLoading}\">\n  </div>\n  <p :class=\"{'invisible': isLoading}\">{{legend}}.</p>\n</template>\n\n<script>\nimport * as d3 from \"d3\"\n\nexport default {\n  props: ['results', 'isLoading'],\n  data() {\n    return {\n      noResults: false,\n      legend: \"\"\n    }\n  },\n  watch : {\n    results(newvalue) {\n      this.makeViz(newvalue)\n    }\n  },\n  methods: {\n    makeViz(results)\n    {\n      this.legend = \"Frequency of the words \" + results.query.join(\", \") + \" (aggregated) in \" + results.aggregate_results.length + \" cookbooks\"\n\n      var el_w = this.$refs.viz.clientWidth;\n      \n      var margin = {top: 10, right: 30, bottom: 30, left: 60},\n          width = el_w - margin.left - margin.right,\n          height = 400 - margin.top - margin.bottom;\n\n      //d3.select(\"svg\").remove();\n      const div = document.querySelector('#viz');\n      [].slice.call(div.children).forEach(child => div.removeChild(child))\n\n      var svg = d3.select(\"#viz\")\n        .append(\"svg\")\n          .attr(\"width\", width + margin.left + margin.right)\n          .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"g\")\n          .attr(\"transform\",\n                \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n      const data = results.aggregate_results\n\n      // Displays error message if no results\n      if (data == false) {\n        this.noResults = true\n        return false\n      } else {\n        this.noResults = false\n      }\n\n      const lowess = results.lowess\n\n      // create a tooltip\n      var Tooltip = d3.select(\"body\")\n        .append(\"div\")\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"tooltip\")\n\n      // Two functions for tooltips\n      var mouseover = function(event, d) {\n        Tooltip\n          .style(\"opacity\", 1)\n          .style(\"left\", (event.pageX + 10) + \"px\")\n          .style(\"top\", (event.pageY) + \"px\")\n          .html(\"<em>\" + d.title + \"</em><br>Publication year: \" + d.pub_year)\n\n        d3.select(this)\n          .style(\"stroke\", \"black\")\n          .style(\"opacity\", 1)\n\n      }\n\n      var mouseleave = function() {\n        Tooltip\n          .style(\"opacity\", 0)\n        d3.select(this)\n          .style(\"stroke\", \"none\")\n          .style(\"opacity\", 0.8)\n      }\n\n      var max_year = d3.max(data, function(d) { return +d.pub_year;} );\n      var min_year = d3.min(data, function(d) { return +d.pub_year;} );\n\n      var max_freq = d3.max(data, function(d) { return +d.frequency;} );\n\n      var x = d3.scaleLinear()\n          .domain([min_year - 5, max_year + 5])\n          .range([ 0, width ]);\n\n      svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(d3.axisBottom(x)\n                .tickFormat(d3.format(\"d\")))\n\n      // Add Y axis\n      var y = d3.scaleLinear()\n        .domain([0, max_freq + 0.001])\n        .range([ height, 0]);\n      svg.append(\"g\")\n        .call(d3.axisLeft(y));\n      \n      // Adds lowess curves, starting with stderr\n      // If there are more than X points\n      if (data.length >= 10) {\n        var area = d3.area()\n                   .x(function(d)  { return x(d.year); })\n                   .y0(function(d) { return y(d.ul); })\n                   .y1(function(d) { return d.ll > 0 ? y(d.ll) : y(0); }); \n\n        svg.append(\"path\")\n              .datum(lowess)\n              .attr(\"fill\", \"#ccc\")\n              .attr(\"stroke\", \"steelblue\")\n              .attr(\"stroke-width\", 0)\n              .style(\"opacity\", 0.2)\n              .attr(\"d\", area);\n\n        svg.append(\"path\")\n           .datum(lowess)\n           .attr(\"fill\", \"none\")\n           .attr(\"stroke\", \"steelblue\")\n           .attr(\"stroke-width\", 1.5)\n           .attr(\"d\", d3.line()\n            .x(function(d) { return x(d.year) })\n            .y(function(d) { return y(d.lowess) })\n            )\n      }\n      // Add dots\n      svg.append('g')\n        .selectAll(\"dot\")\n        .data(data)\n        .enter()\n        .append(\"circle\")\n          .attr(\"cx\", function (d) { return x(d.pub_year); } )\n          .attr(\"cy\", function (d) { return y(d.frequency); } )\n          .attr(\"r\", 5)\n          .style(\"fill\", \"#69b3a2\")\n        .on(\"mouseover\", mouseover)\n        .on(\"mouseleave\", mouseleave)\n\n    }\n  }\n  \n}\n\n</script>\n\n<style type=\"text/css\">\n  div.tooltip {\n    position: absolute;\n    text-align: left;\n    width: 260px;\n    padding: 5px;\n    font: 12px sans-serif;\n    background: white;\n    border: 1px solid black;\n    pointer-events: none;\n  }\n  .invisible {\n    opacity: 0;\n  }\n</style>","import { render } from \"./viz.vue?vue&type=template&id=28fa5c22\"\nimport script from \"./viz.vue?vue&type=script&lang=js\"\nexport * from \"./viz.vue?vue&type=script&lang=js\"\n\nimport \"./viz.vue?vue&type=style&index=0&id=28fa5c22&lang=css\"\nscript.render = render\n\nexport default script","<template>\n  <facet\n   :title='\"Language\"'\n   :items='languages'\n   :activeBooks='activeBooks'\n   :defaultOpen='true'\n   @setFacets='setFacets'\n   ></facet>\n   <facet\n   :title='\"Type\"'\n   :items='types'\n   :activeBooks='activeBooks'\n   :defaultOpen='true'\n   @setFacets='setFacets'\n   ></facet>\n  <facet\n   :title='\"Publication country\"'\n   :items='countries'\n   :activeBooks='activeBooks'\n   :defaultOpen='false'\n   @setFacets='setFacets'\n   ></facet>\n   <facet\n   :title='\"Series\"'\n   :items='series'\n   :activeBooks='activeBooks'\n   :defaultOpen='false'\n   @setFacets='setFacets'\n   ></facet>\n   <facet\n   :title='\"Publication city\"'\n   :items='cities'\n   :activeBooks='activeBooks'\n   :defaultOpen='false'\n   @setFacets='setFacets'\n   ></facet>\n</template>\n\n<script>\nimport axios from 'axios';\nimport Facet from './facet.vue'\n\nexport default {\n  components: {\n    Facet\n  },\n  data() {\n      return {\n        books: [],\n        activeBooks: [],\n        activeFacets: {},\n        countries: {},\n        cities: {},\n        types: {},\n        languages: {},\n        series: {}\n      }\n    },\n  methods: {\n    setFacets(facetName, ids) {\n      this.activeFacets[facetName] = ids\n      this.setBooks()\n      this.$emit('facetChange', this.activeBooks)\n    },\n    setBooks() {\n      const intersection = (arr1, arr2) => {\n         const res = [];\n         for(let i = 0; i < arr1.length; i++){\n            if(!arr2.includes(arr1[i])){\n               continue;\n            }\n            res.push(arr1[i]);\n         }\n         return res;\n      };\n      const intersectMany = (...arrs) => {\n         let res = arrs[0].slice();\n         for(let i = 1; i < arrs.length; i++){\n            res = intersection(res, arrs[i]);\n         }\n         return res;\n      };\n      // Active books are at the intersection of active facets\n      var allActiveFacets = []\n      Object.values(this.activeFacets).forEach((ids)=>{\n          allActiveFacets.push(ids)\n      })\n      this.activeBooks = intersectMany(...allActiveFacets)\n\n    }\n  },\n  mounted() {\n    var base_url = process.env.NODE_ENV === 'development' ? 'http://127.0.0.1:8000/' : 'https://cookbooks-api.herokuapp.com/'\n    axios({\n        method: 'GET',\n        url: base_url + '/list', \n        headers: {\n                'Access-Control-Allow-Origin': '*',\n                'Content-type': 'application/json'\n            }\n        })\n        .then(response => {\n          // handle success\n          this.$emit('isLoading', false)\n          this.books = response.data\n          this.books.forEach((book) => {\n            this.activeBooks.push(book.id)\n\n            var parseBooks = function (attribute, storage) {\n              // a book can have multiple countries\n              book[attribute].split(\", \").forEach((attribute) => {\n                if (storage[attribute] == undefined){\n                  storage[attribute] = {\n                    'name': attribute,\n                    'ids': []\n                  }\n                }\n                storage[attribute][\"ids\"].push(book.id)\n              })\n            }\n\n            parseBooks(\"country\", this.countries)\n            parseBooks(\"pub_city\", this.cities)\n            parseBooks(\"language\", this.languages)\n            parseBooks(\"series\", this.series)\n            parseBooks(\"type\", this.types)\n\n            \n          })\n        })\n        .catch(error => {\n          // handle error\n          console.log(error)\n        })\n        .finally(() => {            \n        })\n  }\n}\n\n</script>","<template>\n  <div class=\"block\">\n    <div class=\"card\">\n      <header class=\"card-header\">\n        <p class=\"card-header-title\">\n          {{title}}\n        </p>\n        <button class=\"card-header-icon\" aria-label=\"more options\">\n          <span class=\"icon\" \n                v-if=\"facetOpen == false\" \n                @click=\"facetOpen = true\">\n            <i class=\"fas fa-angle-down\" \n               aria-hidden=\"true\"></i>\n           </span>\n           <span class=\"icon\" \n                v-if=\"facetOpen == true\" \n                @click=\"facetOpen = false\">\n            <i class=\"fas fa-angle-up\" \n               aria-hidden=\"true\"></i>\n          </span>\n        </button>\n      </header>\n      <div class=\"card-content\" v-if=\"facetOpen == true\">\n        <div class=\"content\">\n          <div v-for=\"(item, index) in items\" :key=\"index\">\n            <div class=\"columns\" v-if=\"item.name.length > 0\">\n                <div class=\"column\">\n                  <a @click=\"activateFacet(title, item.ids, index)\"\n                     :class=\"{ 'active': activeFacet === index }\">\n                    {{item.name}} \n                    <span class=\"is-size-7\">\n                      ({{intersection(item.ids, activeBooks).length}}/{{item.ids.length}})\n                    </span>\n                  </a>\n              </div>\n              <div class=\"column is-one-quarter has-text-right\"\n                   v-if=\"activeFacet === index\">\n                  <a @click=\"resetFacet()\">\n                   <span class=\"tag is-info is-size-7\">\n                     reset\n                   </span>\n               </a>\n           </div>\n       </div>\n            </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  props: ['title', 'items', 'activeBooks', 'defaultOpen'],\n  data() {\n    return {\n      activeFacet: undefined,\n      facetOpen: this.defaultOpen\n    }\n  },\n  computed:{\n    allIds() {\n      var allIds = []\n      Object.values(this.items).forEach((item)=>{\n          allIds.push(...item.ids)\n      })\n      return allIds\n    }\n  },\n  methods: {\n    activateFacet(name, ids, index) {\n      this.activeFacet = index;\n      this.$emit('setFacets', name, ids)\n    },\n    resetFacet(){\n      this.activateFacet(this.title, this.allIds, undefined)\n    },\n    intersection(arr1, arr2) {\n       const res = []\n       for(let i = 0; i < arr1.length; i++){\n          if(!arr2.includes(arr1[i])){\n             continue\n          }\n          res.push(arr1[i])\n       }\n       return res\n    }\n  }\n}\n</script>\n\n<style>\n.active {\n  font-weight: bold;\n}\n</style>","import { render } from \"./facet.vue?vue&type=template&id=740235a8\"\nimport script from \"./facet.vue?vue&type=script&lang=js\"\nexport * from \"./facet.vue?vue&type=script&lang=js\"\n\nimport \"./facet.vue?vue&type=style&index=0&id=740235a8&lang=css\"\nscript.render = render\n\nexport default script","import { render } from \"./facets.vue?vue&type=template&id=28652702\"\nimport script from \"./facets.vue?vue&type=script&lang=js\"\nexport * from \"./facets.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <p class=\"has-text-right\">\n    <a ref=\"download\" @click=\"makeCSV\">\n      <button class=\"button\">\n          <span>Download data as CSV</span>\n        </button>\n    </a>\n  </p>\n</template>\n\n<script>\nexport default {\n  props: ['results'],\n  methods: {\n    makeCSV() {\n\n      function convertArrayOfObjectsToCSV(args) {\n        var result, ctr, keys, columnDelimiter, lineDelimiter, data;\n\n        data = args.data || null;\n          if (data == null || !data.length) {\n          return null;\n        }\n\n        columnDelimiter = args.columnDelimiter || ',';\n        lineDelimiter = args.lineDelimiter || '\\n';\n\n        keys = Object.keys(data[0]);\n\n        result = '';\n        result += keys.join(columnDelimiter);\n        result += lineDelimiter;\n\n        data.forEach(function(item) {\n        ctr = 0;\n        keys.forEach(function(key) {\n        if (ctr > 0) result += columnDelimiter;\n\n        result += '\"' + item[key] + '\"';\n        ctr++;\n        });\n        result += lineDelimiter;\n        });\n        return result;\n      }\n\n      var csv = 'data:text/csv;charset=utf-8,' + convertArrayOfObjectsToCSV(\n        {'data': this.results.results});\n      var data = encodeURI(csv);\n      var filename = this.results.query.join(\"+\")\n      this.$refs.download.setAttribute('href', data);\n      this.$refs.download.setAttribute('download', filename + \".csv\");\n    }\n  }\n}\n\n</script>","import { render } from \"./dlcsv.vue?vue&type=template&id=65eef259\"\nimport script from \"./dlcsv.vue?vue&type=script&lang=js\"\nexport * from \"./dlcsv.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"columns\">\n    <div class=\"content column is-half is-offset-one-quarter\">\n      <h1>Loading...</h1>\n      <article class=\"message is-info\" v-if=\"showDidyouknow\">\n        <div class=\"message-body\">\n          <p><b>Did you know...</b></p>\n          <p>{{didyouknowText}}</p>\n          <p class=\"is-size-6\">Source: {{didyouknowSource}}.</p>\n        </div>\n      </article>\n    </div>\n  </div>\n</template>\n\n<script>\n  export default {\n    props: ['isLoading'],\n    data() {\n      return {\n        didyouknow: [\n          { \"text\" : \"that Anna Barnekow, chef in Lübeck, always mixed béchamel sauce in her mayonnaise?\",\n            \"source\": \"Norddeutsches Kochbuch (1902), p. 25\"},\n          { \"text\" : \"that Augustin Carême, a jingoist French chef, called Vienna the second-best city for cooking after Paris?\",\n            \"source\": \"Le maitre-d'hôtel français (1842), p. 215\"},\n          { \"text\" : \"that David Amman, a neo neo-Zoroastrian, recommended using coconut milk to replace mother milk?\",\n            \"source\": \"Mazdaznan (1909), p. 71\"}\n        ],\n        showDidyouknow: false,\n        didyouknowText: \"\",\n        didyouknowSource: \"\"\n      }\n    },\n    mounted() {\n\n        function shuffleArray(arr) {\n          for (let i = arr.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [arr[i], arr[j]] = [arr[j], arr[i]];\n          }\n          return arr\n        }\n\n        this.showDidyouknow = false\n        \n        var didyouknow = shuffleArray(this.didyouknow)\n        var j = 0\n          var interval = setInterval(() => {\n            this.showDidyouknow = true\n            this.didyouknowText = didyouknow[j].text\n            this.didyouknowSource = didyouknow[j].source\n\n            if(j < didyouknow.length - 1) { \n              j++\n            } else {\n              clearInterval(interval) \n            }\n            \n          }, 6000)\n      \n    }\n  }\n</script>","import { render } from \"./loader.vue?vue&type=template&id=12642e7a\"\nimport script from \"./loader.vue?vue&type=script&lang=js\"\nexport * from \"./loader.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./App.vue?vue&type=template&id=ef97af0a\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=ef97af0a&lang=css\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./viz.vue?vue&type=style&index=0&id=28fa5c22&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&id=ef97af0a&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./facet.vue?vue&type=style&index=0&id=740235a8&lang=css\""],"sourceRoot":""}