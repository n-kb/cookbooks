(function(t){function e(e){for(var o,s,i=e[0],r=e[1],l=e[2],d=0,f=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&f.push(c[s][0]),c[s]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,i=1;i<n.length;i++){var r=n[i];0!==c[r]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},c={app:0},a=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/cookbooks/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],r=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=r;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"28cf":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),c={class:"section"},a={class:"container"},s={class:"columns"},i={class:"column is-one-quarter"},r=Object(o["f"])("div",{class:"block content"},[Object(o["f"])("h1",{class:"title"},"Cookbooks explorer"),Object(o["f"])("p",null,"Search word frequencies (case-insensitive) in lots of cookbooks! "),Object(o["f"])("p",null,[Object(o["e"])("Share any interesting findings on Twitter "),Object(o["f"])("a",{href:"https://twitter.com/nicolaskb"},"@nicolaskb"),Object(o["e"])(" or over e-mail hi@nkb.fr, and "),Object(o["f"])("a",{href:"https://github.com/n-kb/cookbooks"},"do read the methodology.")])],-1),l={class:"block"},u={class:"column"},d={class:"block"},f={class:"block"},b={class:"block"};function h(t,e,n,h,p,O){var j=Object(o["i"])("Facets"),v=Object(o["i"])("Search"),g=Object(o["i"])("Loader"),k=Object(o["i"])("Viz"),y=Object(o["i"])("DownloadCSV");return Object(o["g"])(),Object(o["c"])("section",c,[Object(o["f"])("div",a,[Object(o["f"])("div",s,[Object(o["f"])("div",i,[r,Object(o["f"])("div",l,[Object(o["f"])(j,{onFacetChange:O.setBooks,onIsLoading:O.setFacetsLoading},null,8,["onFacetChange","onIsLoading"])])]),Object(o["f"])("div",u,[Object(o["f"])("div",d,[Object(o["f"])(v,{activeBooks:p.activeBooks,onResults:O.setResults,onIsLoading:O.setSearchLoading},null,8,["activeBooks","onResults","onIsLoading"])]),Object(o["f"])("div",f,[O.isLoading?(Object(o["g"])(),Object(o["c"])(g,{key:0,isLoading:O.isLoading},null,8,["isLoading"])):Object(o["d"])("",!0),Object(o["f"])(k,{results:p.results,isLoading:O.isLoading},null,8,["results","isLoading"])]),Object(o["f"])("div",b,[O.isLoading?Object(o["d"])("",!0):(Object(o["g"])(),Object(o["c"])(y,{key:0,results:p.results},null,8,["results"]))])])])])])}n("ac1f"),n("841c");var p={class:"field has-addons"},O={class:"control is-expanded"},j={class:"control"},v={key:0,class:"notification is-danger content"},g=Object(o["f"])("p",null,"Please reload the page.",-1);function k(t,e,n,c,a,s){return Object(o["g"])(),Object(o["c"])(o["a"],null,[Object(o["f"])("div",p,[Object(o["f"])("div",O,[Object(o["l"])(Object(o["f"])("input",{"onUpdate:modelValue":e[1]||(e[1]=function(t){return a.query=t}),disabled:1==a.isLoading,class:[{"is-loading":1==a.isLoading},"input is-expanded"],onKeyup:e[2]||(e[2]=Object(o["m"])((function(t){return s.search()}),["enter"])),type:"text",placeholder:"Keyword"},null,42,["disabled"]),[[o["k"],a.query]])]),Object(o["f"])("div",j,[Object(o["f"])("a",{class:"button is-info",onClick:e[3]||(e[3]=function(t){return s.search()}),type:"submit"}," Search ")])]),a.error?(Object(o["g"])(),Object(o["c"])("div",v,[Object(o["f"])("button",{class:"delete",onClick:e[4]||(e[4]=function(t){return a.error=!1})}),Object(o["f"])("p",null,"There was an error: "+Object(o["j"])(a.errorMessage)+".",1),g])):Object(o["d"])("",!0)],64)}n("a15b");var y=n("bc3a"),m=n.n(y),w={props:["activeBooks"],data:function(){return{query:"tomate, tomaten, tomates",isLoading:!1,error:!1,errorMessage:""}},watch:{activeBooks:function(){this.search()}},mounted:function(){this.search()},methods:{search:function(){var t=this;this.isLoading=!0,this.$emit("isLoading",!0);var e="https://cookbooks-api.herokuapp.com/";m()({method:"GET",url:e+"search?ids="+this.activeBooks.join()+"&q="+this.query.toLowerCase(),headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"}}).then((function(e){t.isLoading=!1,t.$emit("isLoading",!1),t.$emit("results",e.data)})).catch((function(e){t.errorMessage=e,t.error=!0}))}}};w.render=k;var F=w,L={key:0,class:"notification is-warning"},S=Object(o["e"])(" Your search returned no results. ");function B(t,e,n,c,a,s){return Object(o["g"])(),Object(o["c"])(o["a"],null,[a.noResults?(Object(o["g"])(),Object(o["c"])("div",L,[Object(o["f"])("button",{class:"delete",onClick:e[1]||(e[1]=function(t){return a.noResults=!1})}),S])):Object(o["d"])("",!0),Object(o["f"])("div",{id:"viz",ref:"viz",class:{invisible:n.isLoading}},null,2),Object(o["f"])("p",{class:{invisible:n.isLoading}},Object(o["j"])(a.legend)+".",3)],64)}n("159b"),n("fb6a");var x=n("898b"),C={props:["results","isLoading"],data:function(){return{noResults:!1,legend:""}},watch:{results:function(t){this.makeViz(t)}},methods:{makeViz:function(t){this.legend="Frequency of the words "+t.query.join(", ")+" (aggregated) in "+t.aggregate_results.length+" cookbooks";var e=this.$refs.viz.clientWidth,n={top:10,right:30,bottom:30,left:60},o=e-n.left-n.right,c=400-n.top-n.bottom,a=document.querySelector("#viz");[].slice.call(a.children).forEach((function(t){return a.removeChild(t)}));var s=x["i"]("#viz").append("svg").attr("width",o+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")"),i=t.aggregate_results;if(0==i)return this.noResults=!0,!1;this.noResults=!1;var r=t.lowess,l=x["i"]("body").append("div").style("opacity",0).attr("class","tooltip"),u=function(t,e){l.style("opacity",1).style("left",t.pageX+10+"px").style("top",t.pageY+"px").html("<em>"+e.title+"</em><br>Publication year: "+e.pub_year),x["i"](this).style("stroke","black").style("opacity",1)},d=function(){l.style("opacity",0),x["i"](this).style("stroke","none").style("opacity",.8)},f=x["f"](i,(function(t){return+t.pub_year})),b=x["g"](i,(function(t){return+t.pub_year})),h=x["f"](i,(function(t){return+t.frequency})),p=x["h"]().domain([b-5,f+5]).range([0,o]);s.append("g").attr("transform","translate(0,"+c+")").call(x["b"](p).tickFormat(x["d"]("d")));var O=x["h"]().domain([0,h+.001]).range([c,0]);if(s.append("g").call(x["c"](O)),i.length>=10){var j=x["a"]().x((function(t){return p(t.year)})).y0((function(t){return O(t.ul)})).y1((function(t){return t.ll>0?O(t.ll):O(0)}));s.append("path").datum(r).attr("fill","#ccc").attr("stroke","steelblue").attr("stroke-width",0).style("opacity",.2).attr("d",j),s.append("path").datum(r).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5).attr("d",x["e"]().x((function(t){return p(t.year)})).y((function(t){return O(t.lowess)})))}s.append("g").selectAll("dot").data(i).enter().append("circle").attr("cx",(function(t){return p(t.pub_year)})).attr("cy",(function(t){return O(t.frequency)})).attr("r",5).style("fill","#69b3a2").on("mouseover",u).on("mouseleave",d)}}};n("6d7f");C.render=B;var q=C;function z(t,e,n,c,a,s){var i=Object(o["i"])("facet");return Object(o["g"])(),Object(o["c"])(o["a"],null,[Object(o["f"])(i,{title:"Language",items:a.languages,activeBooks:a.activeBooks,defaultOpen:!0,onSetFacets:s.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Type",items:a.types,activeBooks:a.activeBooks,defaultOpen:!0,onSetFacets:s.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Publication country",items:a.countries,activeBooks:a.activeBooks,defaultOpen:!1,onSetFacets:s.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Series",items:a.series,activeBooks:a.activeBooks,defaultOpen:!1,onSetFacets:s.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Publication city",items:a.cities,activeBooks:a.activeBooks,defaultOpen:!1,onSetFacets:s.setFacets},null,8,["items","activeBooks","onSetFacets"])],64)}n("caad"),n("2532"),n("07ac"),n("d3b7"),n("1276"),n("b0c0");var _={class:"block"},A={class:"card"},P={class:"card-header"},V={class:"card-header-title"},D={class:"card-header-icon","aria-label":"more options"},M=Object(o["f"])("i",{class:"fas fa-angle-down","aria-hidden":"true"},null,-1),R=Object(o["f"])("i",{class:"fas fa-angle-up","aria-hidden":"true"},null,-1),T={key:0,class:"card-content"},E={class:"content"},I={key:0,class:"columns"},$={class:"column"},K={class:"is-size-7"},G={key:0,class:"column is-one-quarter has-text-right"},J=Object(o["f"])("span",{class:"tag is-info is-size-7"}," reset ",-1);function U(t,e,n,c,a,s){return Object(o["g"])(),Object(o["c"])("div",_,[Object(o["f"])("div",A,[Object(o["f"])("header",P,[Object(o["f"])("p",V,Object(o["j"])(n.title),1),Object(o["f"])("button",D,[0==a.facetOpen?(Object(o["g"])(),Object(o["c"])("span",{key:0,class:"icon",onClick:e[1]||(e[1]=function(t){return a.facetOpen=!0})},[M])):Object(o["d"])("",!0),1==a.facetOpen?(Object(o["g"])(),Object(o["c"])("span",{key:1,class:"icon",onClick:e[2]||(e[2]=function(t){return a.facetOpen=!1})},[R])):Object(o["d"])("",!0)])]),1==a.facetOpen?(Object(o["g"])(),Object(o["c"])("div",T,[Object(o["f"])("div",E,[(Object(o["g"])(!0),Object(o["c"])(o["a"],null,Object(o["h"])(n.items,(function(t,c){return Object(o["g"])(),Object(o["c"])("div",{key:c},[t.name.length>0?(Object(o["g"])(),Object(o["c"])("div",I,[Object(o["f"])("div",$,[Object(o["f"])("a",{onClick:function(e){return s.activateFacet(n.title,t.ids,c)},class:{active:a.activeFacet===c}},[Object(o["e"])(Object(o["j"])(t.name)+" ",1),Object(o["f"])("span",K," ("+Object(o["j"])(s.intersection(t.ids,n.activeBooks).length)+"/"+Object(o["j"])(t.ids.length)+") ",1)],10,["onClick"])]),a.activeFacet===c?(Object(o["g"])(),Object(o["c"])("div",G,[Object(o["f"])("a",{onClick:e[3]||(e[3]=function(t){return s.resetFacet()})},[J])])):Object(o["d"])("",!0)])):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0)])])}var Y=n("2909"),N={props:["title","items","activeBooks","defaultOpen"],data:function(){return{activeFacet:void 0,facetOpen:this.defaultOpen}},computed:{allIds:function(){var t=[];return Object.values(this.items).forEach((function(e){t.push.apply(t,Object(Y["a"])(e.ids))})),t}},methods:{activateFacet:function(t,e,n){this.activeFacet=n,this.$emit("setFacets",t,e)},resetFacet:function(){this.activateFacet(this.title,this.allIds,void 0)},intersection:function(t,e){for(var n=[],o=0;o<t.length;o++)e.includes(t[o])&&n.push(t[o]);return n}}};n("e023");N.render=U;var W=N,X={components:{Facet:W},data:function(){return{books:[],activeBooks:[],activeFacets:{},countries:{},cities:{},types:{},languages:{},series:{}}},methods:{setFacets:function(t,e){this.activeFacets[t]=e,this.setBooks(),this.$emit("facetChange",this.activeBooks)},setBooks:function(){var t=function(t,e){for(var n=[],o=0;o<t.length;o++)e.includes(t[o])&&n.push(t[o]);return n},e=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];for(var c=n[0].slice(),a=1;a<n.length;a++)c=t(c,n[a]);return c},n=[];Object.values(this.activeFacets).forEach((function(t){n.push(t)})),this.activeBooks=e.apply(void 0,n)}},mounted:function(){var t=this,e="https://cookbooks-api.herokuapp.com/";m()({method:"GET",url:e+"/list",headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"}}).then((function(e){t.$emit("isLoading",!1),t.books=e.data,t.books.forEach((function(e){t.activeBooks.push(e.id);var n=function(t,n){e[t].split(", ").forEach((function(t){void 0==n[t]&&(n[t]={name:t,ids:[]}),n[t]["ids"].push(e.id)}))};n("country",t.countries),n("pub_city",t.cities),n("language",t.languages),n("series",t.series),n("type",t.types)}))})).catch((function(t){console.log(t)})).finally((function(){}))}};X.render=z;var Z=X,H={class:"has-text-right"},Q=Object(o["f"])("button",{class:"button"},[Object(o["f"])("span",null,"Download data as CSV")],-1);function tt(t,e,n,c,a,s){return Object(o["g"])(),Object(o["c"])("p",H,[Object(o["f"])("a",{ref:"download",onClick:e[1]||(e[1]=function(){return s.makeCSV&&s.makeCSV.apply(s,arguments)})},[Q],512)])}n("b64b");var et={props:["results"],methods:{makeCSV:function(){function t(t){var e,n,o,c,a,s;return s=t.data||null,null!=s&&s.length?(c=t.columnDelimiter||",",a=t.lineDelimiter||"\n",o=Object.keys(s[0]),e="",e+=o.join(c),e+=a,s.forEach((function(t){n=0,o.forEach((function(o){n>0&&(e+=c),e+='"'+t[o]+'"',n++})),e+=a})),e):null}var e="data:text/csv;charset=utf-8,"+t({data:this.results.results}),n=encodeURI(e),o=this.results.query.join("+");this.$refs.download.setAttribute("href",n),this.$refs.download.setAttribute("download",o+".csv")}}};et.render=tt;var nt=et,ot={class:"columns"},ct={class:"content column is-half is-offset-one-quarter"},at=Object(o["f"])("h1",null,"Loading...",-1),st={key:0,class:"message is-info"},it={class:"message-body"},rt=Object(o["f"])("p",null,[Object(o["f"])("b",null,"Did you know...")],-1),lt={class:"is-size-6"};function ut(t,e,n,c,a,s){return Object(o["g"])(),Object(o["c"])("div",ot,[Object(o["f"])("div",ct,[at,a.showDidyouknow?(Object(o["g"])(),Object(o["c"])("article",st,[Object(o["f"])("div",it,[rt,Object(o["f"])("p",null,Object(o["j"])(a.didyouknowText),1),Object(o["f"])("p",lt,"Source: "+Object(o["j"])(a.didyouknowSource)+".",1)])])):Object(o["d"])("",!0)])])}var dt={props:["isLoading"],data:function(){return{didyouknow:[{text:"that Anna Barnekow, chef in Lübeck, always mixed béchamel sauce in her mayonnaise?",source:"Norddeutsches Kochbuch (1902), p. 25"},{text:"that Augustin Carême, a jingoist French chef, called Vienna the second-best city for cooking after Paris?",source:"Le maitre-d'hôtel français (1842), p. 215"},{text:"that David Amman, a neo neo-Zoroastrian, recommended using coconut milk to replace mother milk?",source:"Mazdaznan (1909), p. 71"}],showDidyouknow:!1,didyouknowText:"",didyouknowSource:""}},mounted:function(){var t=this;function e(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),o=[t[n],t[e]];t[e]=o[0],t[n]=o[1]}return t}this.showDidyouknow=!1;var n=e(this.didyouknow),o=0,c=setInterval((function(){t.showDidyouknow=!0,t.didyouknowText=n[o].text,t.didyouknowSource=n[o].source,o<n.length-1?o++:clearInterval(c)}),6e3)}};dt.render=ut;var ft=dt,bt={name:"App",data:function(){return{results:[],activeBooks:[],isFacetsLoading:!0,isSearchLoading:!0}},computed:{isLoading:function(){return!(!this.isFacetsLoading&&!this.isSearchLoading)}},methods:{setResults:function(t){this.results=t},setFacetsLoading:function(t){this.isFacetsLoading=t},setSearchLoading:function(t){this.isSearchLoading=t},setBooks:function(t){this.activeBooks=t}},components:{Search:F,Viz:q,DownloadCSV:nt,Facets:Z,Loader:ft}};n("a09a");bt.render=h;var ht=bt;Object(o["b"])(ht).mount("#app")},"6d7f":function(t,e,n){"use strict";n("d847")},a09a:function(t,e,n){"use strict";n("ca6d")},ca6d:function(t,e,n){},d847:function(t,e,n){},e023:function(t,e,n){"use strict";n("28cf")}});
//# sourceMappingURL=app.3881a71a.js.map