(function(e){function t(t){for(var o,a,i=t[0],r=t[1],l=t[2],d=0,f=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&f.push(c[a][0]),c[a]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);u&&u(t);while(f.length)f.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,i=1;i<n.length;i++){var r=n[i];0!==c[r]&&(o=!1)}o&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},c={app:0},s=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/cookbooks/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],r=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=r;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"005e":function(e,t,n){"use strict";n("1e57")},"1e57":function(e,t,n){},"28cf":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),c={class:"section"},s={class:"container"},a={class:"columns"},i={class:"column is-one-quarter"},r=Object(o["f"])("div",{class:"block content"},[Object(o["f"])("h1",{class:"title"},"Cookbooks explorer"),Object(o["f"])("p",null,"Search word frequencies (case-insensitive) in lots of cookbooks! "),Object(o["f"])("p",null,[Object(o["e"])("Share any interesting findings on Twitter "),Object(o["f"])("a",{href:"https://twitter.com/nicolaskb"},"@nicolaskb"),Object(o["e"])(" or over e-mail hi@nkb.fr, and "),Object(o["f"])("a",{href:"https://github.com/n-kb/cookbooks"},"do read the methodology.")])],-1),l={class:"block"},u={class:"column"},d={class:"block"},f={class:"block"},b={class:"block"};function h(e,t,n,h,p,O){var j=Object(o["i"])("Facets"),g=Object(o["i"])("Search"),v=Object(o["i"])("Loader"),k=Object(o["i"])("Viz"),y=Object(o["i"])("DownloadCSV");return Object(o["g"])(),Object(o["c"])("section",c,[Object(o["f"])("div",s,[Object(o["f"])("div",a,[Object(o["f"])("div",i,[r,Object(o["f"])("div",l,[Object(o["f"])(j,{onFacetChange:O.setBooks,onIsLoading:O.setFacetsLoading},null,8,["onFacetChange","onIsLoading"])])]),Object(o["f"])("div",u,[Object(o["f"])("div",d,[Object(o["f"])(g,{activeBooks:p.activeBooks,onResults:O.setResults,onIsLoading:O.setSearchLoading},null,8,["activeBooks","onResults","onIsLoading"])]),Object(o["f"])("div",f,[O.isLoading?(Object(o["g"])(),Object(o["c"])(v,{key:0,isLoading:O.isLoading},null,8,["isLoading"])):Object(o["d"])("",!0),Object(o["f"])(k,{results:p.results,isLoading:O.isLoading},null,8,["results","isLoading"])]),Object(o["f"])("div",b,[O.isLoading?Object(o["d"])("",!0):(Object(o["g"])(),Object(o["c"])(y,{key:0,results:p.results},null,8,["results"]))])])])])])}n("ac1f"),n("841c");var p={class:"field has-addons"},O={class:"control is-expanded"},j={class:"control"},g={key:0,class:"notification is-danger content"},v=Object(o["f"])("p",null,"Please reload the page.",-1);function k(e,t,n,c,s,a){return Object(o["g"])(),Object(o["c"])(o["a"],null,[Object(o["f"])("div",p,[Object(o["f"])("div",O,[Object(o["l"])(Object(o["f"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return s.query=e}),disabled:1==s.isLoading,class:[{"is-loading":1==s.isLoading},"input is-expanded"],onKeyup:t[2]||(t[2]=Object(o["m"])((function(e){return a.search()}),["enter"])),type:"text",placeholder:"Keyword"},null,42,["disabled"]),[[o["k"],s.query]])]),Object(o["f"])("div",j,[Object(o["f"])("a",{class:"button is-info",onClick:t[3]||(t[3]=function(e){return a.search()}),type:"submit"}," Search ")])]),s.error?(Object(o["g"])(),Object(o["c"])("div",g,[Object(o["f"])("button",{class:"delete",onClick:t[4]||(t[4]=function(e){return s.error=!1})}),Object(o["f"])("p",null,"There was an error: "+Object(o["j"])(s.errorMessage)+".",1),v])):Object(o["d"])("",!0)],64)}n("a15b");var y=n("bc3a"),m=n.n(y),w={props:["activeBooks"],data:function(){return{query:"tomate, tomaten, tomates",isLoading:!1,error:!1,errorMessage:""}},watch:{activeBooks:function(){this.search()}},mounted:function(){this.search()},methods:{search:function(){var e=this;this.isLoading=!0,this.$emit("isLoading",!0);var t="https://cookbooks-api.herokuapp.com/";m()({method:"GET",url:t+"search?ids="+this.activeBooks.join()+"&q="+this.query.toLowerCase(),headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"}}).then((function(t){e.isLoading=!1,e.$emit("isLoading",!1),e.$emit("results",t.data)})).catch((function(t){e.errorMessage=t,e.error=!0}))}}};w.render=k;var F=w,L={key:0,class:"notification is-warning"},S=Object(o["e"])(" Your search returned no results. ");function B(e,t,n,c,s,a){return Object(o["g"])(),Object(o["c"])(o["a"],null,[s.noResults?(Object(o["g"])(),Object(o["c"])("div",L,[Object(o["f"])("button",{class:"delete",onClick:t[1]||(t[1]=function(e){return s.noResults=!1})}),S])):Object(o["d"])("",!0),Object(o["f"])("div",{id:"viz",ref:"viz",class:{invisible:n.isLoading}},null,2),Object(o["f"])("p",{class:{invisible:n.isLoading}},Object(o["j"])(s.legend),3)],64)}n("159b"),n("fb6a");var x=n("898b"),C={props:["results","isLoading"],data:function(){return{noResults:!1,legend:""}},watch:{results:function(e){this.makeViz(e)}},methods:{makeViz:function(e){if(0!=e.aggregate_results){var t="words "+e.query.join(", ")+" (aggregated)";1==e.query.length&&(t="word "+e.query[0]),this.legend="Frequency of the "+t+" in "+e.aggregate_results.length+" cookbooks."}else this.legend="";var n=this.$refs.viz.clientWidth,o={top:10,right:30,bottom:30,left:60},c=n-o.left-o.right,s=400-o.top-o.bottom,a=document.querySelector("#viz");[].slice.call(a.children).forEach((function(e){return a.removeChild(e)}));var i=x["i"]("#viz").append("svg").attr("width",c+o.left+o.right).attr("height",s+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")"),r=e.aggregate_results;if(0==r)return this.noResults=!0,!1;this.noResults=!1;var l=e.lowess,u=x["i"]("body").append("div").style("opacity",0).attr("class","tooltip"),d=function(e,t){u.style("opacity",1).style("left",e.pageX+10+"px").style("top",e.pageY+"px").html("<em>"+t.title+"</em><br>Publication year: "+t.pub_year),x["i"](this).style("stroke","black").style("opacity",1)},f=function(){u.style("opacity",0),x["i"](this).style("stroke","none").style("opacity",.8)},b=x["f"](r,(function(e){return+e.pub_year})),h=x["g"](r,(function(e){return+e.pub_year})),p=x["f"](r,(function(e){return+e.frequency})),O=x["h"]().domain([h-5,b+5]).range([0,c]);i.append("g").attr("transform","translate(0,"+s+")").call(x["b"](O).tickFormat(x["d"]("d")));var j=x["h"]().domain([0,p+.001]).range([s,0]);if(i.append("g").call(x["c"](j)),r.length>=10){var g=x["a"]().x((function(e){return O(e.year)})).y0((function(e){return j(e.ul)})).y1((function(e){return e.ll>0?j(e.ll):j(0)}));i.append("path").datum(l).attr("fill","#ccc").attr("stroke","steelblue").attr("stroke-width",0).style("opacity",.2).attr("d",g),i.append("path").datum(l).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5).attr("d",x["e"]().x((function(e){return O(e.year)})).y((function(e){return j(e.lowess)})))}i.append("g").selectAll("dot").data(r).enter().append("circle").attr("cx",(function(e){return O(e.pub_year)})).attr("cy",(function(e){return j(e.frequency)})).attr("r",5).style("fill","#69b3a2").on("mouseover",d).on("mouseleave",f)}}};n("005e");C.render=B;var q=C;function z(e,t,n,c,s,a){var i=Object(o["i"])("facet");return Object(o["g"])(),Object(o["c"])(o["a"],null,[Object(o["f"])(i,{title:"Language",items:s.languages,activeBooks:s.activeBooks,defaultOpen:!0,onSetFacets:a.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Type",items:s.types,activeBooks:s.activeBooks,defaultOpen:!0,onSetFacets:a.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Publication country",items:s.countries,activeBooks:s.activeBooks,defaultOpen:!1,onSetFacets:a.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Series",items:s.series,activeBooks:s.activeBooks,defaultOpen:!1,onSetFacets:a.setFacets},null,8,["items","activeBooks","onSetFacets"]),Object(o["f"])(i,{title:"Publication city",items:s.cities,activeBooks:s.activeBooks,defaultOpen:!1,onSetFacets:a.setFacets},null,8,["items","activeBooks","onSetFacets"])],64)}n("caad"),n("2532"),n("07ac"),n("d3b7"),n("1276"),n("b0c0");var _={class:"block"},A={class:"card"},P={class:"card-header"},V={class:"card-header-title"},D={class:"card-header-icon","aria-label":"more options"},M=Object(o["f"])("i",{class:"fas fa-angle-down","aria-hidden":"true"},null,-1),R=Object(o["f"])("i",{class:"fas fa-angle-up","aria-hidden":"true"},null,-1),T={key:0,class:"card-content"},E={class:"content"},I={key:0,class:"columns"},$={class:"column"},K={class:"is-size-7"},G={key:0,class:"column is-one-quarter has-text-right"},J=Object(o["f"])("span",{class:"tag is-info is-size-7"}," reset ",-1);function U(e,t,n,c,s,a){return Object(o["g"])(),Object(o["c"])("div",_,[Object(o["f"])("div",A,[Object(o["f"])("header",P,[Object(o["f"])("p",V,Object(o["j"])(n.title),1),Object(o["f"])("button",D,[0==s.facetOpen?(Object(o["g"])(),Object(o["c"])("span",{key:0,class:"icon",onClick:t[1]||(t[1]=function(e){return s.facetOpen=!0})},[M])):Object(o["d"])("",!0),1==s.facetOpen?(Object(o["g"])(),Object(o["c"])("span",{key:1,class:"icon",onClick:t[2]||(t[2]=function(e){return s.facetOpen=!1})},[R])):Object(o["d"])("",!0)])]),1==s.facetOpen?(Object(o["g"])(),Object(o["c"])("div",T,[Object(o["f"])("div",E,[(Object(o["g"])(!0),Object(o["c"])(o["a"],null,Object(o["h"])(n.items,(function(e,c){return Object(o["g"])(),Object(o["c"])("div",{key:c},[e.name.length>0?(Object(o["g"])(),Object(o["c"])("div",I,[Object(o["f"])("div",$,[Object(o["f"])("a",{onClick:function(t){return a.activateFacet(n.title,e.ids,c)},class:{active:s.activeFacet===c}},[Object(o["e"])(Object(o["j"])(e.name)+" ",1),Object(o["f"])("span",K," ("+Object(o["j"])(a.intersection(e.ids,n.activeBooks).length)+"/"+Object(o["j"])(e.ids.length)+") ",1)],10,["onClick"])]),s.activeFacet===c?(Object(o["g"])(),Object(o["c"])("div",G,[Object(o["f"])("a",{onClick:t[3]||(t[3]=function(e){return a.resetFacet()})},[J])])):Object(o["d"])("",!0)])):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0)])])}var Y=n("2909"),N={props:["title","items","activeBooks","defaultOpen"],data:function(){return{activeFacet:void 0,facetOpen:this.defaultOpen}},computed:{allIds:function(){var e=[];return Object.values(this.items).forEach((function(t){e.push.apply(e,Object(Y["a"])(t.ids))})),e}},methods:{activateFacet:function(e,t,n){this.activeFacet=n,this.$emit("setFacets",e,t)},resetFacet:function(){this.activateFacet(this.title,this.allIds,void 0)},intersection:function(e,t){for(var n=[],o=0;o<e.length;o++)t.includes(e[o])&&n.push(e[o]);return n}}};n("e023");N.render=U;var W=N,X={components:{Facet:W},data:function(){return{books:[],activeBooks:[],activeFacets:{},countries:{},cities:{},types:{},languages:{},series:{}}},methods:{setFacets:function(e,t){this.activeFacets[e]=t,this.setBooks(),this.$emit("facetChange",this.activeBooks)},setBooks:function(){var e=function(e,t){for(var n=[],o=0;o<e.length;o++)t.includes(e[o])&&n.push(e[o]);return n},t=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(var c=n[0].slice(),s=1;s<n.length;s++)c=e(c,n[s]);return c},n=[];Object.values(this.activeFacets).forEach((function(e){n.push(e)})),this.activeBooks=t.apply(void 0,n)}},mounted:function(){var e=this,t="https://cookbooks-api.herokuapp.com/";m()({method:"GET",url:t+"/list",headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"}}).then((function(t){e.$emit("isLoading",!1),e.books=t.data,e.books.forEach((function(t){e.activeBooks.push(t.id);var n=function(e,n){t[e].split(", ").forEach((function(e){void 0==n[e]&&(n[e]={name:e,ids:[]}),n[e]["ids"].push(t.id)}))};n("country",e.countries),n("pub_city",e.cities),n("language",e.languages),n("series",e.series),n("type",e.types)}))})).catch((function(e){console.log(e)})).finally((function(){}))}};X.render=z;var Z=X,H={class:"has-text-right"},Q=Object(o["f"])("button",{class:"button"},[Object(o["f"])("span",null,"Download data as CSV")],-1);function ee(e,t,n,c,s,a){return Object(o["g"])(),Object(o["c"])("p",H,[Object(o["f"])("a",{ref:"download",onClick:t[1]||(t[1]=function(){return a.makeCSV&&a.makeCSV.apply(a,arguments)})},[Q],512)])}n("b64b");var te={props:["results"],methods:{makeCSV:function(){function e(e){var t,n,o,c,s,a;return a=e.data||null,null!=a&&a.length?(c=e.columnDelimiter||",",s=e.lineDelimiter||"\n",o=Object.keys(a[0]),t="",t+=o.join(c),t+=s,a.forEach((function(e){n=0,o.forEach((function(o){n>0&&(t+=c),t+='"'+e[o]+'"',n++})),t+=s})),t):null}var t="data:text/csv;charset=utf-8,"+e({data:this.results.results}),n=encodeURI(t),o=this.results.query.join("+");this.$refs.download.setAttribute("href",n),this.$refs.download.setAttribute("download",o+".csv")}}};te.render=ee;var ne=te,oe={class:"columns"},ce={class:"content column is-half is-offset-one-quarter"},se=Object(o["f"])("h1",null,"Loading...",-1),ae={key:0,class:"message is-info"},ie={class:"message-body"},re=Object(o["f"])("p",null,[Object(o["f"])("b",null,"Did you know...")],-1),le={class:"is-size-6"};function ue(e,t,n,c,s,a){return Object(o["g"])(),Object(o["c"])("div",oe,[Object(o["f"])("div",ce,[se,s.showDidyouknow?(Object(o["g"])(),Object(o["c"])("article",ae,[Object(o["f"])("div",ie,[re,Object(o["f"])("p",null,Object(o["j"])(s.didyouknowText),1),Object(o["f"])("p",le,"Source: "+Object(o["j"])(s.didyouknowSource)+".",1)])])):Object(o["d"])("",!0)])])}var de={props:["isLoading"],data:function(){return{didyouknow:[{text:"that Anna Barnekow, chef in Lübeck, always mixed béchamel sauce in her mayonnaise?",source:"Norddeutsches Kochbuch (1902), p. 25"},{text:"that Augustin Carême, a jingoist French chef, called Vienna the second-best city for cooking after Paris?",source:"Le maitre-d'hôtel français (1842), p. 215"},{text:"that David Amman, a neo-Zoroastrian, recommended using coconut milk to replace mother milk?",source:"Mazdaznan (1909), p. 71"}],showDidyouknow:!1,didyouknowText:"",didyouknowSource:""}},mounted:function(){var e=this;function t(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),o=[e[n],e[t]];e[t]=o[0],e[n]=o[1]}return e}this.showDidyouknow=!1;var n=t(this.didyouknow),o=0,c=setInterval((function(){e.showDidyouknow=!0,e.didyouknowText=n[o].text,e.didyouknowSource=n[o].source,o<n.length-1?o++:clearInterval(c)}),6e3)}};de.render=ue;var fe=de,be={name:"App",data:function(){return{results:[],activeBooks:[],isFacetsLoading:!0,isSearchLoading:!0}},computed:{isLoading:function(){return!(!this.isFacetsLoading&&!this.isSearchLoading)}},methods:{setResults:function(e){this.results=e},setFacetsLoading:function(e){this.isFacetsLoading=e},setSearchLoading:function(e){this.isSearchLoading=e},setBooks:function(e){this.activeBooks=e}},components:{Search:F,Viz:q,DownloadCSV:ne,Facets:Z,Loader:fe}};n("a09a");be.render=h;var he=be;Object(o["b"])(he).mount("#app")},a09a:function(e,t,n){"use strict";n("ca6d")},ca6d:function(e,t,n){},e023:function(e,t,n){"use strict";n("28cf")}});
//# sourceMappingURL=app.cd272d15.js.map